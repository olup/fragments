(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{162:function(n,e,t){"use strict";t.r(e);var i,c,r,o,a,l,d,s,b,u,j,h,O=t(0),p=t.n(O),f=t(59),x=t.n(f),v=t(16),g=t(49),m=t(9),y=t(33),k=t(1),w=function(){return Object(k.jsx)(y.a,{styles:Object(y.b)(i||(i=Object(m.a)(['\n      @import url("https://fonts.googleapis.com/css2?family=Inconsolata:wght@200;300;400;500;600;700&display=swap");\n\n      /* http://meyerweb.com/eric/tools/css/reset/ \n   v2.0 | 20110126\n   License: none (public domain)\n*/\n\n      html,\n      body,\n      div,\n      span,\n      applet,\n      object,\n      iframe,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5,\n      h6,\n      p,\n      blockquote,\n      pre,\n      a,\n      abbr,\n      acronym,\n      address,\n      big,\n      cite,\n      code,\n      del,\n      dfn,\n      em,\n      img,\n      ins,\n      kbd,\n      q,\n      s,\n      samp,\n      small,\n      strike,\n      strong,\n      sub,\n      sup,\n      tt,\n      var,\n      b,\n      u,\n      i,\n      center,\n      dl,\n      dt,\n      dd,\n      ol,\n      ul,\n      li,\n      fieldset,\n      form,\n      label,\n      legend,\n      table,\n      caption,\n      tbody,\n      tfoot,\n      thead,\n      tr,\n      th,\n      td,\n      article,\n      aside,\n      canvas,\n      details,\n      embed,\n      figure,\n      figcaption,\n      footer,\n      header,\n      hgroup,\n      menu,\n      nav,\n      output,\n      ruby,\n      section,\n      summary,\n      time,\n      mark,\n      audio,\n      video {\n        margin: 0;\n        padding: 0;\n        border: 0;\n        font-size: 100%;\n        font: inherit;\n        vertical-align: baseline;\n      }\n      /* HTML5 display-role reset for older browsers */\n      article,\n      aside,\n      details,\n      figcaption,\n      figure,\n      footer,\n      header,\n      hgroup,\n      menu,\n      nav,\n      section {\n        display: block;\n      }\n      body {\n        line-height: 1;\n      }\n      ol,\n      ul {\n        list-style: none;\n      }\n      blockquote,\n      q {\n        quotes: none;\n      }\n      blockquote:before,\n      blockquote:after,\n      q:before,\n      q:after {\n        content: "";\n        content: none;\n      }\n      table {\n        border-collapse: collapse;\n        border-spacing: 0;\n      }\n\n      *,\n      body,\n      input,\n      textarea {\n        font-family: "Inconsolata", monospace;\n      }\n\n      body {\n        min-height: 100vh;\n        display: flex;\n        a {\n          text-decoration: none;\n          color: inherit;\n        }\n        #root {\n          width: 100%;\n        }\n      }\n    '])))})},C=t(12),S=t.n(C),B=t(7),F=t(43),z=t(103),q=Object(v.createHttpLink)({uri:"http://localhost:10000/graphql"}),E=t(15),A=E.a.div(c||(c=Object(m.a)(["\n  flex: 1;\n"]))),H=E.a.div(r||(r=Object(m.a)(["\n  flex: 1;\n  min-height: 100%;\n  display: flex;\n  justify-content: center;\n  background-color: #eee;\n"]))),L=E.a.div(o||(o=Object(m.a)(["\n  flex: 1;\n  justify-content: center;\n  display: flex;\n"]))),T=E.a.div(a||(a=Object(m.a)(["\n  width: 1000px;\n  padding-top: 100px;\n"]))),D=E.a.div((function(n){return{marginTop:n.mt,marginBottom:n.mb,marginRight:n.mr,marginLeft:n.ml,height:n.h,width:n.w,justifyContent:n.justify,alignItems:n.align,display:"flex",position:"relative",flexDirection:n.col?"column":"row"}})),M=t(23),P=t(4),I=Object(v.gql)(l||(l=Object(m.a)(["\n    mutation deleteFragment($uuid: ID!) {\n  done: deleteFragment(uuid: $uuid)\n}\n    "])));function $(n){return v.useMutation(I,n)}Object(v.gql)(d||(d=Object(m.a)(["\n    query getFragmentsHandle {\n  fragments {\n    uuid\n    handle\n    previewContent\n  }\n}\n    "])));var N=Object(v.gql)(s||(s=Object(m.a)(["\n    query getFragmentByHandle($handle: String!) {\n  fragmentByHandle(handle: $handle) {\n    uuid\n    handle\n    content\n    createdAt\n    tags\n    linkedBy {\n      uuid\n      handle\n      previewContent\n    }\n    linksTo {\n      handle\n      uuid\n      previewContent\n    }\n  }\n}\n    "])));function V(n){return v.useQuery(N,n)}var R=Object(v.gql)(b||(b=Object(m.a)(["\n    query getFragments($filter: SearchFragmentInput) {\n  fragments(filter: $filter) {\n    uuid\n    handle\n    content\n    createdAt\n    tags\n    linkedBy {\n      uuid\n      handle\n      previewContent\n    }\n    linksTo {\n      handle\n      uuid\n      previewContent\n    }\n  }\n}\n    "])));function K(n){return v.useQuery(R,n)}var W=Object(v.gql)(u||(u=Object(m.a)(["\n    query getFragmentsPreview($filter: SearchFragmentInput) {\n  fragments(filter: $filter) {\n    uuid\n    handle\n    previewContent\n  }\n}\n    "])));var Z=Object(v.gql)(j||(j=Object(m.a)(["\n    query getTags {\n  tags\n}\n    "])));function Q(n){return v.useQuery(Z,n)}var U=Object(v.gql)(h||(h=Object(m.a)(["\n    mutation saveFragment($fragment: FragmentInput!) {\n  fragment: saveFragment(fragment: $fragment) {\n    uuid\n    content\n    handle\n  }\n}\n    "])));function J(n){return v.useMutation(U,n)}var Y,G,X,_,nn,en,tn,cn,rn=t(41),on=t(18),an=t(64),ln=Object(E.a)(D)(Y||(Y=Object(m.a)(["\n  padding: 10px 15px;\n  border-radius: 5px;\n  font-size: 20px;\n  background-color: #d9d9d9;\n  color: #4d4d4d;\n  cursor: pointer;\n  align-items: center;\n\n  &:hover {\n    color: #d9d9d9;\n    background-color: #4d4d4d;\n  }\n\n  svg {\n    margin-right: 10px;\n  }\n"]))),dn=E.a.div(G||(G=Object(m.a)(["\n  /**\n * ==============================================\n * Dot Flashing\n * ==============================================\n */\n\n  position: relative;\n  width: 10px;\n  height: 10px;\n  // border-radius: 5px;\n  background-color: rgba(0, 0, 0, 0.05);\n  color: rgba(0, 0, 0, 0.05);\n  animation: dotFlashing ","s infinite normal;\n  animation-delay: ",'s;\n\n  &::before,\n  &::after {\n    content: "";\n    display: inline-block;\n    position: absolute;\n    top: 0;\n  }\n\n  &::before {\n    left: -15px;\n    width: 10px;\n    height: 10px;\n    //border-radius: 5px;\n    background-color: rgba(0, 0, 0, 0.05);\n    color: rgba(0, 0, 0, 0.05);\n    animation: dotFlashing ',"s infinite normal;\n    animation-delay: 0s;\n  }\n\n  &::after {\n    left: 15px;\n    width: 10px;\n    height: 10px;\n    // border-radius: 5px;\n    background-color: rgba(0, 0, 0, 0.05);\n    color: rgba(0, 0, 0, 0.05);\n    animation: dotFlashing ","s infinite normal;\n    animation-delay: ","s;\n  }\n\n  @keyframes dotFlashing {\n    0%,\n    50%,\n    100% {\n      background-color: rgba(0, 0, 0, 0.05);\n    }\n    80% {\n      background-color: rgba(0, 0, 0, 0.5);\n    }\n  }\n"])),2,2/3,2,2,2/3*2),sn=E.a.div(X||(X=Object(m.a)(["\n  width: ","px;\n  box-sizing: border-box;\n  overflow: hidden;\n  color: #aaa;\n  transition: 0.5s;\n\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  font-size: 20px;\n\n  z-index: 100;\n"])),(function(n){return n.isVisible?250:0})),bn=E.a.div(_||(_=Object(m.a)(["\n  background-color: #222;\n  width: ","px;\n  padding: 20px;\n  padding-top: 50px;\n  height: 100%;\n  box-sizing: border-box;\n"])),250),un=E.a.span(nn||(nn=Object(m.a)(["\n  position: fixed;\n  top: 10px;\n  left: 20px;\n  padding: 3px;\n  color: #aaa;\n  cursor: pointer;\n  &:hover {\n    border-bottom: 1px dashed;\n  }\n"]))),jn=E.a.div(en||(en=Object(m.a)(["\n  font-weight: bold;\n  margin-bottom: 5px;\n"]))),hn=E.a.input(tn||(tn=Object(m.a)(["\n  padding: 10px 20px;\n  border: none;\n  outline: none;\n  font-size: 18px;\n  width: 100%;\n  opacity: 0.5;\n  &:hover,\n  &:focus {\n    opacity: 1;\n  }\n"]))),On=function(){var n,e,t=Object(O.useState)(!1),i=Object(P.a)(t,2),c=i[0],r=i[1],o=Object(O.useState)(""),a=Object(P.a)(o,2),l=a[0],d=a[1],s=Q(),b=Object(M.a)((null===s||void 0===s||null===(n=s.data)||void 0===n?void 0:n.tags)||[]).sort(),u=Object(an.useDebounce)(l,1e3),j=Object(P.a)(u,1)[0],h=(e={skip:!l,variables:{filter:{content:j,handle:j}}},v.useQuery(W,e)),p=h.data,f=h.loading,x=Object(O.useMemo)((function(){return(null===p||void 0===p?void 0:p.fragments)||[]}),[null===p||void 0===p?void 0:p.fragments]);Object(O.useEffect)((function(){var n;c&&(null===s||void 0===s||null===(n=s.refetch)||void 0===n||n.call(s))}),[c]);var g=Object(O.useCallback)((function(){r(!c),d("")}),[c,r,d]);return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(sn,{isVisible:c,style:{position:"relative"}}),Object(k.jsx)(sn,{isVisible:c,children:Object(k.jsxs)(bn,{children:[Object(k.jsxs)(un,{onClick:g,children:[c?"Hide":"Show"," Side"]}),Object(k.jsx)(on.b,{to:"/handle/new",style:{marginBottom:20},children:Object(k.jsxs)(ln,{children:[Object(k.jsx)(rn.d,{size:15})," New fragment"]})}),Object(k.jsxs)(D,{mb:20,mr:-20,ml:-20,children:[Object(k.jsx)(hn,{placeholder:"search",value:l,onChange:function(n){return d(n.target.value)}}),f&&Object(k.jsx)(D,{style:{position:"absolute",right:25,top:15},children:Object(k.jsx)(dn,{})})]}),!l&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(jn,{style:{marginBottom:10},children:Object(k.jsx)(on.b,{to:"/",children:"Home"})}),Object(k.jsx)(jn,{style:{marginBottom:10},children:Object(k.jsx)(on.b,{to:"/feed",children:"Feed"})}),Object(k.jsx)(jn,{children:"Tags"}),null===b||void 0===b?void 0:b.map((function(n){return Object(k.jsx)("div",{children:Object(k.jsxs)(on.b,{to:"/tag/"+n,children:["#",n]})})}))]}),l&&Object(k.jsx)(k.Fragment,{children:null===x||void 0===x?void 0:x.map((function(n){return Object(k.jsx)("div",{children:Object(k.jsx)(on.b,{to:"/handle/"+n.handle,children:n.handle})})}))})]})})]})},pn=E.a.span(cn||(cn=Object(m.a)(["\n  cursor: pointer;\n  color: #ccc;\n  border-bottom: 1px dashed transparent;\n  &:hover {\n    color: #222;\n    border-color: #222;\n  }\n"]))),fn=t(65),xn=t.n(fn),vn=t(10),gn=t(28),mn=t(106),yn=t.n(mn);var kn,wn=Object(gn.a)(D,{target:"emdbafd4"})({name:"1o68xg7",styles:"font-size:20px;color:#ccc;display:inline-flex"}),Cn=Object(gn.a)("div",{target:"emdbafd3"})(""),Sn=Object(gn.a)("div",{target:"emdbafd2"})("padding:20px 30px;background-color:white;width:100%;box-sizing:border-box;box-shadow:7px 7px 0px 0px #00000008;",Cn,"{opacity:0;}&:hover ",Cn,"{opacity:1;}"),Bn=Object(gn.a)(yn.a,{target:"emdbafd1"})({name:"1jdopto",styles:'margin-bottom:20px;padding-bottom:5px;& input{padding:0;color:#ccc;min-width:0;border:none;outline:none;background-color:transparent;font-family:"Inconsolata",monospace;font-size:20px;&:hover,&:focus{background-color:#e2f8ff;box-shadow:0 0 0 5px #e2f8ff;color:#222;}}'}),Fn=Object(gn.a)(D,{target:"emdbafd0"})({name:"y0ab5d",styles:"font-size:20px;color:#ccc;svg{margin-right:10px;}"}),zn=t(164),qn=Object(O.createContext)(undefined),En=qn.Provider,An=t(24),Hn=t(5),Ln=t(68),Tn={"^\\* ":"list-item","^- ":"list-item","^\\+ ":"list-item","^> ":"block-quote","^# ":"heading-one","^## ":"heading-two","^### ":"heading-three","^\\/\\/ ":"comment"},Dn={"^> (.*$)":"quote","\\*(.*)\\*":"italic","\\*\\*(.*)\\*\\*":"bold","\\B(@[a-zA-Z-]+\\b)(?!;)":"handle","\\B(@[a-zA-Z-]+:inline\\b)(?!;)":"inlineHandle","\\B(#[a-zA-Z-]+\\b)(?!;)":"hashtag","(?!```)`(.+)`":"code"},Mn=[],Pn=Object(O.createContext)(Mn),In=Pn.Provider,$n=function(){return Object(O.useContext)(Pn)},Nn=function(n){var e=n.handle,t=void 0===e?"":e,i=V({variables:{handle:t},fetchPolicy:"cache-and-network"}),c=i.data,r=i.loading,o=null===c||void 0===c?void 0:c.fragmentByHandle,a=J(),l=Object(P.a)(a,1)[0];return Object(k.jsx)(se,{initialValue:(null===o||void 0===o?void 0:o.content)||"",onSave:function(n){r||l({variables:{fragment:{uuid:null===o||void 0===o?void 0:o.uuid,handle:t,content:n}}})},autoSave:!0,handle:t},null===o||void 0===o?void 0:o.uuid)},Vn=function(n){var e=n.attributes,t=n.children,i=n.element,c=$n();switch(i.type){case"editor-pre-handle":return Object(k.jsx)("div",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"pre-code-fence":return Object(k.jsx)("div",Object(B.a)(Object(B.a)({},e),{},{style:{opacity:.1},children:t}));case"code":return Object(k.jsx)("div",Object(B.a)(Object(B.a)({},e),{},{style:{backgroundColor:"#353535",color:"#ccc",padding:"5px 30px",margin:"0px -30px"},children:t}));case"block-quote":return Object(k.jsx)("blockquote",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"bulleted-list":return Object(k.jsx)("ul",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"heading-one":return Object(k.jsx)("h1",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"heading-two":return Object(k.jsx)("h2",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"heading-three":return Object(k.jsx)("h3",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"list-item":return Object(k.jsx)("li",Object(B.a)(Object(B.a)({},e),{},{children:t}));case"comment":return Object(k.jsx)("p",Object(B.a)(Object(B.a)({},e),{},{style:{opacity:.5},children:t}));case"editor":return c.includes(i.handle)?Object(k.jsx)("div",Object(B.a)(Object(B.a)({},e),{},{children:t})):Object(k.jsx)("div",Object(B.a)(Object(B.a)({},e),{},{children:Object(k.jsxs)("div",{contentEditable:!1,style:{margin:"0px -30px 10px -30px"},children:[Object(k.jsx)("span",{style:{display:"none"},children:t}),Object(k.jsx)("div",{contentEditable:!1,style:{padding:"10px 30px",backgroundColor:"rgb(241 241 241 / 45%)",marginTop:-2},children:Object(k.jsx)(Nn,{handle:i.handle})})]})}));default:return Object(k.jsx)("p",Object(B.a)(Object(B.a)({},e),{},{className:i.type,children:t}))}},Rn=E.a.span(kn||(kn=Object(m.a)(["\n  background-color: #353535;\n  color: #eee;\n  border-radius: 3px;\n"]))),Kn=t(66),Wn=function(n){var e=Object(O.useState)(!1),t=Object(P.a)(e,2),i=t[0],c=t[1];function r(e){e.key===n&&c(!0)}var o=function(e){e.key===n&&c(!1)};return Object(O.useEffect)((function(){return window.addEventListener("keydown",r),window.addEventListener("keyup",o),function(){window.removeEventListener("keydown",r),window.removeEventListener("keyup",o)}}),[]),i};var Zn,Qn,Un,Jn,Yn,Gn,Xn,_n=Object(gn.a)("div",{target:"e1wqs7sw1"})({name:"1i27z53",styles:"width:auto;z-index:10;width:max-content;max-width:400px;position:absolute;bottom:100%;left:0;padding-bottom:10px;div.content{border:1px solid #dfdfdf;background-color:white;box-shadow:0 0 5px rgba(0, 0, 0, 0.1);padding:10px;font-size:14px;}"}),ne=Object(gn.a)("span",{target:"e1wqs7sw0"})("position:relative;",_n,"{visibility:hidden;opacity:0;transition:visibility 0s,opacity 0.2s,transform 0.2s;transform:translateY(-10px);}&:hover ",_n,"{visibility:visible;opacity:1;transform:translateY(0px);}"),ee=function(n){var e=n.children,t=n.hide,i=n.previewContent,c=n.handle;return Object(k.jsxs)(ne,{children:[Object(k.jsx)("span",{children:e}),!t&&Object(k.jsx)(_n,{contentEditable:!1,className:"preview",children:i?Object(k.jsxs)("div",{className:"content",children:[Object(k.jsx)("div",{style:{opacity:.5,marginBottom:5},children:"Preview"}),Object(k.jsxs)("div",{style:{marginBottom:5},children:[i,"..."]}),Object(k.jsx)(on.b,{to:"/handle/"+c,children:Object(k.jsx)(pn,{children:"Open"})})]}):Object(k.jsx)("div",{className:"content",children:Object(k.jsx)(on.b,{to:"/handle/"+c,children:Object(k.jsx)(pn,{children:"Create"})})})})]})},te=Object(gn.a)("span",{target:"egt2mh60"})("background-color:",(function(n){return n.exists?"#e2f8ff":"#f1f1f1"}),";padding:0 5px;",(function(n){return n.inline&&Object(y.b)(Zn||(Zn=Object(m.a)(["\n      opacity: 0.2;\n      padding-right: 0;\n      background-color: transparent;\n    "])))})," ",(function(n){return n.showAsLink&&Object(y.b)(Qn||(Qn=Object(m.a)(["\n      cursor: pointer;\n      &:hover {\n        border-bottom: 1px dashed;\n      }\n    "])))}),";"),ie=function(n){var e,t=n.text,i=n.children,c=n.inline,r=Object(Kn.a)(n,["text","children","inline"]),o=Object(vn.h)(),a=(null===t||void 0===t?void 0:t.slice(1))||"",l=Object(O.useContext)(qn),d=null===l||void 0===l||null===(e=l.linksTo)||void 0===e?void 0:e.find((function(n){return(null===n||void 0===n?void 0:n.handle)===a})),s=Wn("Control"),b=Wn("Meta"),u=s||b;return Object(k.jsx)(ee,{handle:a,hide:c,previewContent:(null===d||void 0===d?void 0:d.previewContent)||void 0,children:Object(k.jsx)(te,Object(B.a)(Object(B.a)({},r),{},{inline:c,exists:!!d,showAsLink:u,onClick:function(n){return(n.ctrlKey||n.metaKey)&&o("/handle/"+a)},children:Object(k.jsx)("span",{children:i})}))})},ce=E.a.span(Un||(Un=Object(m.a)(["\n  background-color: #ffebcc;\n  padding: 0 5px;\n\n  ","\n"])),(function(n){return n.showAsLink&&Object(y.b)(Jn||(Jn=Object(m.a)(["\n      cursor: pointer;\n      &:hover {\n        border-bottom: 1px dashed;\n      }\n    "])))})),re=function(n){var e=n.text,t=n.children,i=Object(Kn.a)(n,["text","children"]),c=Object(vn.h)(),r=Wn("Control"),o=Wn("Meta"),a=r||o;return Object(k.jsx)(ce,Object(B.a)(Object(B.a)({showAsLink:a,onClick:function(n){return(n.ctrlKey||n.metaKey)&&c("/tag/"+e.slice(1))}},i),{},{children:t}))},oe=function(n){var e=n.attributes,t=n.children,i=n.leaf;return"handle"===i.type?Object(k.jsx)(ie,Object(B.a)(Object(B.a)({text:i.text},e),{},{children:t})):"inlineHandle"===i.type?Object(k.jsx)(ie,Object(B.a)(Object(B.a)({text:i.text,inline:!0},e),{},{children:t})):"hashtag"===i.type?Object(k.jsx)(re,Object(B.a)(Object(B.a)({},e),{},{text:i.text,children:t})):"code"===i.type?Object(k.jsx)(Rn,Object(B.a)(Object(B.a)({},e),{},{children:t})):Object(k.jsx)("span",Object(B.a)(Object(B.a)({style:{fontWeight:"bold"===i.type?"bold":"normal",fontStyle:"italic"===i.type?"italic":"normal"}},e),{},{children:t}))},ae=E.a.div(Yn||(Yn=Object(m.a)(["\n  width: 100%;\n  //background-color: white;\n  font-size: 20px;\n  line-height: 1.2;\n\n  & .public-DraftEditorPlaceholder-root {\n    position: absolute;\n    opacity: 0.3;\n    pointer-events: none;\n  }\n\n  & i {\n    font-style: italic;\n  }\n\n  & b {\n    font-weight: bold;\n  }\n\n  & h1 {\n    font-size: 35px;\n    font-weight: bold;\n    margin-bottom: 20px;\n  }\n\n  & h2 {\n    font-size: 30px;\n    font-weight: bold;\n    margin-bottom: 20px;\n  }\n\n  & h3 {\n    font-size: 25px;\n    font-weight: bold;\n    margin-bottom: 20px;\n  }\n\n  & li,\n  & ul {\n    list-style-type: none;\n    margin-left: 40px;\n    text-indent: -20px;\n    margin-bottom: 20px;\n\n    & + li,\n    & + ul {\n      margin-top: -20px;\n    }\n  }\n\n  & .paragraph,\n  & p {\n    margin-bottom: 20px;\n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n"]))),le=function(n){var e=Object(P.a)(n,2),t=e[0],i=e[1],c=[];if(Hn.f.isText(t)){var r=t.text;Object.keys(Dn).forEach((function(n){for(var e,t=new RegExp(n,"gim");null!==(e=t.exec(r));){var o=e.index,a=e.index+e[0].length;c.push({anchor:{path:i,offset:o},focus:{path:i,offset:a},type:Dn[n]})}}))}return c},de=function(n){return n.filter((function(n){return!n.preventSerialization})).map((function(n){return Hn.c.string(n)})).join("\n")},se=function(n){var e=n.onChange,t=n.handle,i=void 0===t?"":t,c=n.initialValue,r=void 0===c?"":c,o=n.autoFocus,a=n.autoSave,l=void 0!==a&&a,d=n.spellCheck,s=void 0!==d&&d,b=n.onSave,u=n.onBlur,j=Object(O.useRef)(null);Object(O.useEffect)((function(){var n;o&&(null===(n=j.current)||void 0===n||n.focus())}),[o]);var h=Object(O.useState)(r.split("\n").map((function(n){return{type:"paragraph",children:[{text:n}]}}))),p=Object(P.a)(h,2),f=p[0],x=p[1],v=Object(O.useState)(null),g=Object(P.a)(v,2),m=g[0],y=g[1],w=Object(O.useMemo)((function(){return Object(Ln.c)(function(n){var e=n.isVoid;return n.isVoid=function(n){return"editor"===n.type||e(n)},n}(function(n){var e=n.normalizeNode;return n.normalizeNode=function(n){e(n)},n}(Object(Hn.h)())))}),[]),C=Object(an.useDebouncedCallback)(Object(F.a)(S.a.mark((function n(){return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:null===b||void 0===b||b(de(f));case 1:case"end":return n.stop()}}),n)}))),1e3),B=function(n){var t=Object(An.a)(n),i=Object(An.a)(w.selection||{}),c=null;t.forEach((function(n,e){var i,r,o,a,l;"editor"!==n.type&&""===(null===n||void 0===n||null===(i=n.children)||void 0===i||null===(r=i[0])||void 0===r?void 0:r.text)&&(n.type="paragraph"),Object.keys(Tn).forEach((function(e){var t;(null===(t=n.children[0].text)||void 0===t?void 0:t.match(new RegExp(e)))&&(n.type=Tn[e])})),"```"===(null===n||void 0===n||null===(o=n.children)||void 0===o||null===(a=o[0])||void 0===a?void 0:a.text)&&(c?(n.type="pre-code-fence",t[c].type="pre-code-fence",t.slice(c+1,e).forEach((function(n){return n.type="code"})),c=null):c=e),(null===(l=n.children[0].text)||void 0===l?void 0:l.match(new RegExp("^@[a-zA-Z-]+:inline$")))&&(n.type="editor-pre-handle","editor"!==t[e+1].type&&t.splice(e+1,0,{type:"editor",preventSerialization:!0,handle:n.children[0].text.replace("@","").replace(":inline",""),children:[{text:""}]})),"editor"===n.type&&"editor-pre-handle"!==t[e-1].type&&t.splice(e,1)}));var r=Object(An.b)(t),o=Object(An.b)(i);x(r),y(o),null===e||void 0===e||e(de(r)),l&&C.callback()};Object(O.useEffect)((function(){B(f)}),[]),Object(O.useEffect)((function(){m&&Hn.g.setSelection(w,m)}),[m]);var z=$n();return Object(k.jsx)(In,{value:[].concat(Object(M.a)(z),[i]),children:Object(k.jsx)(ae,{children:Object(k.jsx)(Ln.b,{editor:w,value:f,onChange:B,ref:j,children:Object(k.jsx)(Ln.a,{renderElement:Vn,autoFocus:!0,decorate:le,renderLeaf:oe,onBlur:function(n){null===u||void 0===u||u(n),null===b||void 0===b||b(de(f))},spellCheck:s})})})})},be=function(n){var e,t=n.fragment,i=n.onDelete,c=n.autoFocus,r=function(n,e){var t,i=Object(vn.h)(),c=Object(O.useState)(!1),r=Object(P.a)(c,2),o=r[0],a=r[1],l=Object(O.useState)(!1),d=Object(P.a)(l,2),s=d[0],b=d[1],u=Object(O.useState)(0),j=Object(P.a)(u,2),h=j[0],p=j[1],f=Object(O.useState)(0),x=Object(P.a)(f,2),v=x[0],g=x[1],m=Object(O.useState)((null===n||void 0===n?void 0:n.handle)||xn()({separator:"-",capitalize:!1})),y=Object(P.a)(m,2),k=y[0],w=y[1],C=Object(O.useState)((null===n||void 0===n?void 0:n.uuid)||void 0),B=Object(P.a)(C,2),z=B[0],q=B[1],E=Object(O.useState)((null===n||void 0===n?void 0:n.content)||""),A=Object(P.a)(E,2),H=A[0],L=A[1],T=Object(O.useCallback)((function(n){p(n.length),g(n.length?n.split(" ").length:0)}),[]),D=J(),M=Object(P.a)(D,2),I=M[0],$=M[1].loading,N=Object(O.useCallback)(Object(F.a)(S.a.mark((function n(){var e,t,i,c;return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((z||H)&&o&&!$){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,I({variables:{fragment:{content:H,handle:k,uuid:z}}});case 4:return i=n.sent,(c=null===(e=i.data)||void 0===e||null===(t=e.fragment)||void 0===t?void 0:t.uuid)&&c!==z&&q(c),a(!1),n.abrupt("return",i);case 9:case"end":return n.stop()}}),n)}))),[o,z,H,k,$,I]),V=Object(O.useCallback)((function(n){H!==n&&(L(n),a(!0))}),[]);return Object(O.useEffect)((function(){T(H)}),[H,T]),{hasBackLinks:!!(null===n||void 0===n||null===(t=n.linkedBy)||void 0===t?void 0:t.length),setHandle:w,onSave:N,onContentChange:V,onHandleChange:function(n){w(n),a(!0)},goToHandlePage:function(n){(n.ctrlKey||n.metaKey)&&i("/handle/"+n.currentTarget.value)},useSpellCheck:s,setUseSpellCheck:b,handle:k,w:v,c:h,uuid:z}}(t),o=r.handle,a=r.hasBackLinks,l=r.onSave,d=r.onContentChange,s=r.onHandleChange,b=r.goToHandlePage,u=r.useSpellCheck,j=r.setUseSpellCheck,h=r.uuid;return Object(k.jsx)(En,{value:t||void 0,children:Object(k.jsxs)(D,{col:!0,w:"100%",children:[Object(k.jsxs)(Sn,{children:[Object(k.jsx)(Cn,{children:Object(k.jsxs)(D,{children:[Object(k.jsx)(Bn,{value:o,onChange:function(n){return s(n.target.value)},spellCheck:!1,onBlur:function(){return l()},onClick:b}),Object(k.jsx)(A,{}),Object(k.jsx)("div",{children:Object(k.jsx)(pn,{onClick:function(){return null===i||void 0===i?void 0:i(h||void 0)},children:Object(k.jsx)(rn.e,{})})})]})}),Object(k.jsx)(se,{autoFocus:c,onChange:d,initialValue:(null===t||void 0===t?void 0:t.content)||"",handle:o,autoSave:!0,spellCheck:u,onSave:l}),Object(k.jsx)(Cn,{children:Object(k.jsxs)(D,{style:{marginTop:20},children:[Object(k.jsx)(wn,{children:Object(zn.a)((null===t||void 0===t?void 0:t.createdAt)||new Date,"dd/MM/yyyy")}),Object(k.jsx)(wn,{ml:10,children:Object(k.jsx)(pn,{onClick:function(){return j(!u)},children:Object(k.jsx)(rn.a,{})})}),Object(k.jsx)(wn,{ml:10,children:Object(k.jsx)(pn,{children:Object(k.jsx)(rn.b,{})})}),Object(k.jsx)(A,{})]})})]}),a&&Object(k.jsxs)(Fn,{mt:20,children:[Object(k.jsx)(rn.c,{}),null===t||void 0===t||null===(e=t.linkedBy)||void 0===e?void 0:e.map((function(n){return Object(k.jsx)(D,{mr:10,children:Object(k.jsx)(ee,{handle:n.handle,previewContent:n.previewContent,children:Object(k.jsx)(on.b,{to:"/handle/"+(null===n||void 0===n?void 0:n.handle),children:Object(k.jsx)(pn,{children:null===n||void 0===n?void 0:n.handle})})})})}))]})]})})},ue=function(){var n=Object(vn.h)(),e=Object(vn.i)().handle,t=V({variables:{handle:e},fetchPolicy:"cache-and-network"}),i=t.data,c=t.loading,r=null===i||void 0===i?void 0:i.fragmentByHandle,o=$(),a=Object(P.a)(o,1)[0],l=c&&!r;return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(on.b,{to:"/",children:Object(k.jsx)(pn,{children:"Back home"})})}),l&&Object(k.jsx)(D,{justify:"center",mt:50,children:Object(k.jsx)(dn,{})}),!l&&Object(k.jsx)(be,{fragment:r||{handle:e,content:"",linksTo:[],linkedBy:[],tags:[]},onDelete:function(){(null===r||void 0===r?void 0:r.uuid)&&a({variables:{uuid:null===r||void 0===r?void 0:r.uuid}}),n("/")}},null===r||void 0===r?void 0:r.handle)]})},je=t(110),he=t.n(je),Oe=E.a.div(Gn||(Gn=Object(m.a)(["\n  padding: 20px;\n  background-color: white;\n  width: 100%;\n  font-style: italic;\n  color: #ccc;\n  font-size: 20px;\n  cursor: text;\n"]))),pe=function(n){var e=n.onOutsideClick,t=n.placeholder,i=void 0===t?"What's on your mind ?":t,c=Object(O.useState)(!1),r=Object(P.a)(c,2),o=r[0],a=r[1];return o?o?Object(k.jsx)("div",{style:{width:"100%"},children:Object(k.jsx)(he.a,{onOutsideClick:function(){a(!1),null===e||void 0===e||e()},children:Object(k.jsx)(be,{autoFocus:!0,onDelete:function(){return a(!1)}})})}):null:Object(k.jsx)(Oe,{onClick:function(){return a(!0)},children:i})},fe=function(){var n=K({fetchPolicy:"cache-and-network"}),e=n.data,t=n.refetch,i=Object(O.useMemo)((function(){return null===e||void 0===e?void 0:e.fragments}),[e]),c=K({variables:{filter:{tags:"star"}}}).data,r=Object(O.useMemo)((function(){return null===c||void 0===c?void 0:c.fragments}),[c]),o=$(),a=Object(P.a)(o,1)[0],l=function(n){a({variables:{uuid:n}}),t()};return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(on.b,{to:"/",children:Object(k.jsx)(pn,{children:"Back home"})})}),Object(k.jsx)(D,{children:Object(k.jsx)(pe,{onOutsideClick:function(){return t()}})}),!!(null===r||void 0===r?void 0:r.length)&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(D,{style:{justifyContent:"center",margin:"50px 0",color:"#bbb"},children:"Star Fragments"}),null===r||void 0===r?void 0:r.map((function(n){return Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(be,{fragment:n,onDelete:function(n){return n&&l(n)}})},n.uuid)}))]}),!!(null===i||void 0===i?void 0:i.length)&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(D,{style:{justifyContent:"center",margin:"50px 0",color:"#bbb"},children:"Recent Fragments"}),null===i||void 0===i?void 0:i.filter((function(n){return!(null===r||void 0===r?void 0:r.find((function(e){return e.uuid===n.uuid})))})).map((function(n){return Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(be,{fragment:n,onDelete:function(n){return n&&l(n)}})},n.uuid)}))]})]})},xe=function(){var n=K({variables:{filter:{tags:"home"}},fetchPolicy:"cache-and-network"}),e=n.data,t=n.loading,i=n.refetch,c=null===e||void 0===e?void 0:e.fragments,r=$(),o=Object(P.a)(r,1)[0];return Object(k.jsxs)("div",{children:[Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(pe,{onOutsideClick:i,placeholder:"New fragment"})}),t&&!(null===c||void 0===c?void 0:c.length)&&Object(k.jsx)(D,{justify:"center",mt:50,children:Object(k.jsx)(dn,{})}),!t&&!(null===c||void 0===c?void 0:c.length)&&Object(k.jsx)(D,{style:{justifyContent:"center",margin:"50px 0",color:"#bbb"},children:'To add a fragment to your home, just tag it "#home"'}),null===c||void 0===c?void 0:c.map((function(n){return Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(be,{fragment:n,onDelete:function(n){return n&&function(n){o({variables:{uuid:n}}),i()}(n)}})},n.uuid)}))]})},ve=(E.a.div(Xn||(Xn=Object(m.a)(["\n  margin: 10px 0;\n"]))),function(){var n=Object(vn.i)().tag,e=K({variables:{filter:{tags:n}}}),t=e.data,i=e.refetch,c=e.loading,r=Object(O.useMemo)((function(){return null===t||void 0===t?void 0:t.fragments}),[t]),o=Q({fetchPolicy:"cache-and-network"}).data,a=null===o||void 0===o?void 0:o.tags.filter((function(e){return e.startsWith(n+"-")})),l=$(),d=Object(P.a)(l,1)[0];return Object(k.jsxs)(D,{col:!0,children:[Object(k.jsx)(on.b,{to:"/",children:Object(k.jsx)(pn,{children:"Back home"})}),Object(k.jsxs)(D,{mt:10,mb:20,style:{color:"#bbb",fontSize:40},children:["#",n]}),!!(null===a||void 0===a?void 0:a.length)&&Object(k.jsx)(D,{mb:30,children:a.map((function(n){return Object(k.jsx)(on.b,{to:"/tag/"+n,children:Object(k.jsxs)(pn,{style:{marginRight:10},children:["#",n]})})}))}),c&&!(null===r||void 0===r?void 0:r.length)&&Object(k.jsx)(D,{justify:"center",mt:50,children:Object(k.jsx)(dn,{})}),null===r||void 0===r?void 0:r.map((function(n){return Object(k.jsx)(D,{style:{marginBottom:20},children:Object(k.jsx)(be,{fragment:n,onDelete:function(n){return n&&function(n){d({variables:{uuid:n}}),i()}(n)}})},n.uuid)}))]},n)}),ge=function(){var n=Object(g.b)(),e=n.loginWithRedirect,t=n.isLoading,i=n.isAuthenticated;return t?Object(k.jsx)(H,{children:Object(k.jsx)(D,{justify:"center",align:"center",children:Object(k.jsx)(dn,{})})}):i?Object(k.jsx)(on.a,{children:Object(k.jsxs)(H,{children:[Object(k.jsx)(On,{}),Object(k.jsx)(L,{children:Object(k.jsx)(T,{children:Object(k.jsxs)(vn.d,{children:[Object(k.jsx)(vn.b,{path:"/",children:Object(k.jsx)(xe,{})}),Object(k.jsx)(vn.b,{path:"/feed",children:Object(k.jsx)(fe,{})}),Object(k.jsx)(vn.b,{path:"/handle/:handle",children:Object(k.jsx)(ue,{})}),Object(k.jsx)(vn.b,{path:"/handle/new",children:Object(k.jsx)(vn.a,{to:"/handle/"+xn()({capitalize:!1,separator:"-"})})}),Object(k.jsx)(vn.b,{path:"/tag/:tag",children:Object(k.jsx)(ve,{})})]})})})]})}):(e(),Object(k.jsx)(H,{}))},me=function(){var n=function(n){var e=Object(z.a)(function(){var e=Object(F.a)(S.a.mark((function e(t,i){var c,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=i.headers,e.next=3,n();case 3:return r=e.sent,e.abrupt("return",{headers:Object(B.a)(Object(B.a)({},c),{},{authorization:r?"Bearer ".concat(r):""})});case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}());return{client:new v.ApolloClient({link:e.concat(q),cache:new v.InMemoryCache({typePolicies:{Fragment:{keyFields:["uuid"],fields:{createdAt:{read:function(n){return new Date(n)}}}},User:{keyFields:["email"]}}})})}}(Object(g.b)().getAccessTokenSilently).client;return Object(k.jsxs)(v.ApolloProvider,{client:n,children:[Object(k.jsx)(w,{}),Object(k.jsx)(ge,{})]})},ye=function(){return Object(k.jsx)(g.a,{domain:"fragment-app.eu.auth0.com",clientId:"Zt12A3VhpiI83mOPs3S0MgOqf1NpWO94",redirectUri:window.location.origin,audience:"https://fragment.ml",children:Object(k.jsx)(me,{})})};x.a.render(Object(k.jsx)(p.a.StrictMode,{children:Object(k.jsx)(ye,{})}),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.dcdab99f.chunk.js.map